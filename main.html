<!DOCTYPE html>
<html ng-app = "people_supervision">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
	    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
		<meta http-equiv="Pragma" content="no-cache" />
		<meta http-equiv="Expires" content="0" />
	
	    <meta name="keywords" content="精准云帮扶，帮扶商城">
	    <meta name="description" content="华夏云城，全国第一家精准云帮扶平台。">
	
	    <meta name="apple-mobile-web-app-capable" content="yes">
	    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
	    <meta content="telephone=no" name="format-detection">
		<title></title>
		<!--民生监督-->
		<link rel="stylesheet" type="text/css" href="css/mui.min.css"/>
		<link rel="stylesheet" type="text/css" href="css/all.css"/>
		<link rel="stylesheet" type="text/css" href="css/people_supervision.css"/>
		<link rel="stylesheet" type="text/css" href="css/wx_icon.css"/>
		<link rel="stylesheet" type="text/css" href="css/view.css"/>
		<script src="js/userAgent.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/angular.min.js" type="text/javascript" charset="utf-8"></script>
	</head>
	<style type="text/css">
 		*{font-family: "微软雅黑" !important;}
		.my-slider{
			/*margin-top: 40px;*/
		}
		h4{
			font-size: 16px;
			color: #000;
            overflow: hidden;
		}
		.supervision-title{
			font-size: 16px;
			color: #000;
		}
		.supervision-select-box a p{
			font-size: 12px;
		}
		@media only screen and (max-width: 320px){
			h4{
			font-size: 12px;
			
			}
		.supervision-title{
			font-size: 14px;
		}	
	}
			/* 新版发布样式			 */
			#btn,#btn1,#btn2{
				height: 50px;
				width: 50px;
				line-height: 50px;
				text-align: center;
				border-radius: 50%;
				cursor: pointer;
			}
			#btn{
				background: rgba(102,102,102,1);
				position: absolute;
				bottom: 0;
				right: 0px;
			}
			#btn1{
				background: rgba(157,206,118,.8);
				position: absolute;
				opacity: 0;
				top: 0;
			}
			#btn2{
				background: rgba(233,151,153,.8);
				position: absolute;
				opacity: 0;
				top: 0;
				left: 0;
			}
			.box{
				position: fixed;
				bottom: 60px;
				z-index: 99;
				right:10px; 
				width: 50px;
				height: 50px;
				color: #fff;
			}
			.hide{
				display: none;
			}
			/* banner样式冲突解决  */
			.mui-slider.my-slider img {
				height: 200px !important;
				width: 100% !important;
				object-fit: cover !important;
			}
        /*查看全文*/
            span.showText{
                color: #4305fb;
                display: inline-block;
                float: right;

            }

	</style>
	<body>
		<!-- <header class="header"></header> -->
		<getregion class="getRegion"></getregion>
		<footer class="footer"></footer>
		<div id="scrollToTop" class="backTop hide"> 
			<span class="mui-icon mui-icon-arrowup"></span> 
		</div>
		<div class="mui-content"  ng-controller = "supervision">
			<div id="refreshContainer" class="mui-content mui-scroll-wrapper" style="margin-bottom: 50px;">
			<div class="mui-scroll">
			<!--滑动模块-->
			<div class="mui-slider my-slider" id="banners">
			 <!--轮播图-->
				  <div class="mui-slider-group mui-slider-loop">
				    <!-- 额外增加的一个节点(循环轮播：第一个节点是最后一张轮播) -->
				    <div class="mui-slider-item mui-slider-item-duplicate">
				      <a href="#">
				        <img src="img/icon/banner_defalt2.jpg">
				      </a>
				    </div>
				    <!-- 第一张 -->
				    <div class="mui-slider-item">
				      <a href="#">
				       <img src="img/icon/banner_defalt1.jpg">
				      </a>
				    </div>
				    <!-- 第二张 -->
				    <div class="mui-slider-item">
				      <a href="#">
				       <img src="img/icon/banner_defalt2.jpg">
				      </a>
				    </div>
				    
				    <!-- 额外增加的一个节点(循环轮播：最后一个节点是第一张轮播) -->
				    <div class="mui-slider-item mui-slider-item-duplicate">
				      <a href="#">
				        <img src="img/icon/banner_defalt1.jpg">
				      </a>
				    </div>
				  </div>
				  <div class="mui-slider-indicator" >
				    <div class="mui-indicator mui-active"></div>
				    <div class="mui-indicator"></div>
				  </div>
			</div>
			<!--选项模块-->
			<div class="supervision-select-box">
				<ul>
					<li data-link="people_project.html">
						<a>
							<img src="img/main/icon1.png" alt="">
							<p>项目大监督</p>
						</a>
					</li>
					<li data-link="people_policy.html">
						<a>
							<img src="img/main/icon2.png" alt="">
							<p>政策大宣传</p>
						</a>
					</li>
					<li data-link="people_publish.html">
						<a>
							<img src="img/main/icon3.png" alt="">
							<p>信息大发布</p>
						</a>
					</li>
					<li data-link="village_publicity.html">
						<a>
							<img src="img/main/icon4.png" alt="">
							<p>服务大通道</p>
						</a>
						
					</li>
					<li data-link="people_learn.html">
						<a>
							<img src="img/main/icon5.png" alt="">
							<p>农业学习</p>
						</a>
						
					</li>
					<!--<li data-link="people_project.html">
						<a>
							<i class="icon wx-xiangmu"></i>
							<p>民生工程</p>
							<p>大监督</p>
						</a>
					</li>
					<li data-link="people_goods.html">
						<a>
							<i class="icon wx-wz"></i>
							<p>民生物资</p>
							<p>大监督</p>
						</a>
						
					</li> -->
					<!--<li data-link="people_poor.html">
						<a>
							<i class="icon wx-gongjijin"></i>
							<p>扶贫资金</p>
							<p>大监督</p>
						</a>
						
					</li>-->
					<!-- <li data-link="people_policy.html">
						<a>
							<i class="icon wx-tp"></i>
							<p>民生政策</p>
							<p>大宣传</p>
						</a>
					</li>
					<li data-link="people_policy.html">
						<a>
							<i class="icon wx-jianyi"></i>
							<p>民生信息</p>
							<p>大发布</p>
						</a>
					</li>
					<li data-link="people_letter.html">
						<a>
							<i class="icon wx-xx"></i>
							<p>信访通道</p>
						</a>
						
					</li>
					<li data-link="village_publicity.html">
						<a >
							<i class="icon wx-yewuxinxi"></i>
							<p>村村公示</p>	
						</a>
						
					</li> -->
					<!--<li data-link="people_search.html#/search1">
						<a>
							<i class="icon wx-chaxun"></i>
							<p>我要查询</p>
						</a>
						
					</li>-->
				</ul>
			</div>
			<!--列表模块-->
			
			<div class="supervision-reply-list">
				<ul class="mui-table-view" id="list">
				    <li class="mui-table-view-cell supervision-title">民生工作大家议</li>
				    <!--<li class="mui-table-view-cell">
				    	<h4 class="Text_ellipsis">坑坑洼洼的路谁来管</h4>
				    	<div class="supervision-img-box clear">
				    		<img src="img/slider1.jpg"/>
				    		<img src="img/slider2.jpg"/>
				    		<img src="img/slider3.jpg"/>
				    		<img src="img/slider4.jpg"/>
				    	</div>
				 
				    	<p><span>0次浏览</span>&nbsp;&nbsp;<span>2017-01-26</span><span class="manage">已处理</span></p>
				    </li>
				    <li class="mui-table-view-cell">
				    	<h4 class="Text_ellipsis" style="-webkit-line-clamp:3">坑坑洼洼的路谁来管</h4>
				    	<div class="supervision-img-box clear">
				    		<img src="img/slider1.jpg"/>
				    		<img src="img/slider2.jpg"/>
				    		<img src="img/slider3.jpg"/>
				    		<img src="img/slider4.jpg"/>
				    	</div>
				 
				    	<p><span>0次浏览</span>&nbsp;&nbsp;<span>2017-01-26</span><span>未处理</span></p>
				    </li>-->
				</ul>
			</div>
			</div>
			</div>
			<!--我要曝光模块-->
			<div class="box">
				<div id="btn">
					<!-- &nbsp;
					<i class="mui-icon mui-icon-compose" style="font-family: Muiicons !important;font-size:35px !important;text-align: center;line-height:50px"></i> -->
					<img src="img/edit.png" alt="" style="height:50px;width:50px">	
				</div>
				<div id="btn1" class="hide"><i class="icon wx-bg" style="font-size:25px !important;display:inline-block;margin-top:13px"></i></div>
				<div id="btn2" class="hide">
					<!-- <i class="icon wx-dz"></i> -->
					<img src="img/dz.png" style="height:25px;width:25px;margin-top:10px" alt="">	
				</div>
			</div>
		</div>
		<div class="locationMark">
		</div>
		<div class="locationSelect">
			<ul class="mui-table-view locationHeader">
			    <li class="mui-table-view-cell">选择地区</li>
			</ul>
		</div>  
		<script src="js/jquery-1.8.3.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/mui.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/angular-route.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/public_templete.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/people_supervision.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/all.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/mui.zoom.js"></script>
		<script src="js/mui.previewimage.js"></script>
		<script type="text/javascript">
			mui.init({
		        pullRefresh: {
		            container: '#refreshContainer',
		            up: {
		            	auto:true,
		                contentrefresh: '正在加载...',
		                callback: pullupRefresh
		            }
		        }
			});
				mui.previewImage();
		    //  记录下一页数据
				var num = '';
		    function pullupRefresh(){
		    	if(num==null){
		    		mui('#refreshContainer').pullRefresh().endPullupToRefresh(true);
		    	}else{
	    			HuaXia.Ajax({
			    		type:'get',
			    		url:API.SUPERVISE.exposures,
			    		data : {next_start:num}
			    	},function(data){
			    		/*console.log(data);*/
			    		if(data.exposures==undefined){
				    		jQuery("body").css("height",'100%');
				    		jQuery("html").css("height",'100%');
				    		jQuery(".mui-content").html(netError(data.msg)).css("height",'100%');
				    		return;
				    	}
				    	if(data.exposures.length==0){
			    			mui('#refreshContainer').pullRefresh().endPullupToRefresh(true);
			    			/*jQuery("#list").append(notdata("这里空空如也，快去点赞或者曝光吧！"));*/
			    		}else{
			    			//第一次加载头部轮播图
			    			if(num==''){
			    				var imgdata = data.banners;
			    				if(imgdata.length==0){
			    					jQuery("#banners").css("background","url(img/icon/banner.png) no-repeat center center");
			    				}else{
			    					HuaXia.Eachbanners(imgdata,1);
			    					//	轮播图滚动
									var gallery = mui('.mui-slider .my-slider');
									if(imgdata.length>1){
										gallery.slider({
									        interval:5000//自动轮播周期，若为0则不自动播放，默认为0；
									    });
									}
			    					jQuery("#banners").find("img").attr("onerror","javascript:this.src='"+serverPath.img()+"icon/banner.png'").css("height",window.innerWidth*9/16);
			    				}
			    				
			    			}
			    				//	轮播图滚动
							var gallery = mui('.mui-slider');
							    gallery.slider({
							        interval:5000//自动轮播周期，若为0则不自动播放，默认为0；
							    });
			    			$.each(data.exposures, function(j,da,a) {
			    				var ev = document.getElementById('list');
			    				var dom = 'li';
			    				var obj = ['class','mui-table-view-cell','id',da._id];
//			    				图片遍历
								var imgHTML='';
								da.images&&$.each(da.images, function(i,d) {
									imgHTML = imgHTML + '<img src="'+IMG_web+d+'" data-preview-src="" data-preview-group="'+j+'" />';
								});
//			    				时间获取
								var time = parseInt(da.timed);
								var Date = HuaXia.format(time,1);
								if(da.type==1){
									var detail = '<span><i class="icon wx-dz" style="font-size: 16px;padding-right: 5px;"></i></span>';
								}else{
									if(da.disposaled==true){
										var detail = '<span class="manage">已处理</span>';
									}else{
										var detail = '<span>未处理</span>';
									}
								}
			    				var html = '<h4>'+da.content+'</h4><div id="read-more" style="padding-right: 10px;"></div>'+
			    						   '<div class="supervision-img-box clear">'+imgHTML+'</div>'+
			    						   '<p><span style="color:#7CDA7B"><img src="img/see.png" style="height:15px;vertical-align: sub;">&nbsp;&nbsp;'+da.views+'</span>&nbsp;&nbsp;<span>'+Date+'</span>'+detail+'</p>';
			    				HuaXia.Addhtml(ev,dom,html,obj);
			    				jQuery("#list").find("img").attr("onerror","javascript:this.src='"+serverPath.img()+"icon/avator_default.png'")
			    			});
			    			//处理显示全部
                            document.querySelectorAll('.mui-table-view-cell h4').forEach(function(item){
                                 var slideHeight = 66; // px
                                 var defHeight = $(item).height();
                                 var ev = $(item);
                                 if(defHeight >= slideHeight) {
                                     ev.css('height' , slideHeight + 'px');
                                     ev.parent().find('#read-more').append('<span class="showText">查看全文</span>');
                                     ev.parent().find('#read-more span').on('tap',function(){
                                         var curHeight = ev.height();
                                          if(curHeight == slideHeight){
                                            ev.animate({
                                                 height: defHeight
                                             }, "normal");
                                            ev.parent().find('#read-more span').html('隐藏');
                                          }else{
                                            ev.animate({
                                                 height: slideHeight
                                             }, "normal");
                                            ev.parent().find('#read-more span').html('查看全文');
                                          }
                                     })
                                 }
                            })
			    			mui('#refreshContainer').pullRefresh().endPullupToRefresh();
							num = data.next_start;
			    			}
			    	});
		    	}
		    }
			
		</script>
	</body>
</html>
